#!/bin/bash

source ${EOS_SCRIPT_PATH}/job.bash

export EOS_SEED=88793216
export EOS_ANALYSIS_INFO=0

export EOS_IS_SEED=13466416
export EOS_IS_SAMPLES=100000

export EOS_MCMC_BURN_IN=
export EOS_MCMC_COVARIANCE="Kstar-FF-cov.txt"
#  mode of a chain without subleading parameters
export EOS_MCMC_INITIAL_VALUES="fixed
Re{c9}   +3.4394605710072206
Im{c9}   -1.7543479205162102
Re{c9'}  -0.8647164576344489
Im{c9'}  +0.7609324734851706
Re{c10}  -3.3038898111412900
Im{c10}  +1.1445419307753084
Re{c10'} -0.5618616640690678
Im{c10'} +0.5545255521184100
Re{cS}   +0.1517624223424861
Im{cS}   -0.0219948816045895
Re{cS'}  +0.2064754152704285
Im{cS'}  +0.0972345567040651
Re{cP}   +0.3465408931169071
Im{cP}   +0.1944795702432591
Re{cP'}  +0.2365972914356623
Im{cP'}  +0.1982536050821568
Re{cT}   +0.0972729265888573
Im{cT}   +0.0335345544056988
Re{cT5}  +0.0464521844972746
Im{cT5}  -0.1407099427315097
CKM::A      +0.8116007499316086
CKM::lambda +0.2253309683783748
CKM::rhobar +0.1356292791536537
CKM::etabar +0.3643055359354256
mass::c               +1.2676686671345425
mass::b(MSbar)        +4.1667179670869858
B->K::F^p(0)@KMPW2010 +0.3311696192699850
B->K::b^p_1@KMPW2010  -2.8027690137089518
B->K::b^0_1@KMPW2010  -5.2404119517616969
B->K::F^t(0)@KMPW2010 +0.2978174457145521
B->K::b^t_1@KMPW2010  -2.5514146216198452

B->K^*::alpha^A0_0@BSZ2015  +0.3452337739124565
B->K^*::alpha^A0_1@BSZ2015  -1.1087085864835373
B->K^*::alpha^A0_2@BSZ2015  +0.5704588790335645
B->K^*::alpha^A1_0@BSZ2015  +0.2631390002114646
B->K^*::alpha^A1_1@BSZ2015  +0.0984448321693593
B->K^*::alpha^A1_2@BSZ2015  +0.2260935878433681
B->K^*::alpha^A12_1@BSZ2015 +0.5845917959320619
B->K^*::alpha^A12_2@BSZ2015 +0.6264660613806687
B->K^*::alpha^V_0@BSZ2015   +0.3512821788839395
B->K^*::alpha^V_1@BSZ2015   -1.0898108218968501
B->K^*::alpha^V_2@BSZ2015   +1.3063593102133764
B->K^*::alpha^T1_0@BSZ2015  +0.3113894590433426
B->K^*::alpha^T1_1@BSZ2015  -0.9775613410467735
B->K^*::alpha^T1_2@BSZ2015  +1.1801771034598922
B->K^*::alpha^T2_1@BSZ2015  +0.3895142344628705
B->K^*::alpha^T2_2@BSZ2015  +0.5891659815313831
B->K^*::alpha^T23_0@BSZ2015 +0.6795964887333209
B->K^*::alpha^T23_1@BSZ2015 +1.2369783509532792
B->K^*::alpha^T23_2@BSZ2015 +0.9742253270780514
decay-constant::B_s +0.2248049286857171
"
export EOS_MCMC_PROPOSAL='gauss'
export EOS_MCMC_SAMPLES=500000
export EOS_MCMC_SCALE_REDUCTION=1
export EOS_MCMC_UPDATE_SIZE=500

export EOS_VB_COMPONENTS_PER_GROUP=4
export EOS_VB_REL_TOL=0.0001
export EOS_VB_SKIP_INITIAL=0
export EOS_VB_THIN=1

export EOS_OPT_MAXEVAL=50000

# best solution from one chain
export GOF_MODE_0="{ +4.1640303147982332 -0.6324822278499826 -0.2847212193778462 +0.9203938049728355 -3.3402044183906270 +0.2746530256577933 -0.1350587015174616 -0.4864822492310823 +0.1138488251210648 +0.1012905310816592 +0.1462484911057214 +0.1727066418157668 -0.0532003901805956 -0.0103038645804911 -0.0657153243455284 +0.0532928173897983 +0.0511370519899747 +0.2004324195842285 +0.1207727823672241 -0.1855330738504581 +0.8269865030330950 +0.2241831874034775 +0.1103404347116265 +0.3560926270980753 +1.3104218929804574 +4.1527108876920371 +0.3504481879039360 -2.5773979546345180 -5.1565110992528247 +0.3428964570594158 -1.5529849669278841 -0.1082043393561493 -0.7916194736589809 -0.0044086353096036 -0.0586805103342077 +1.0579150028599067 +0.9697885537402346 +0.9273270421080598 +1.0445914628631767 +0.3412397151012922 +0.9109826386592588 +1.1560263576304646 +0.3231698155545891 -1.2118764464944141 +1.1044142454109611 +0.2724188175072956 +0.0956032285148621 -0.0225683504910594 +0.2906020000302598 -0.9946708527921020 +0.3517148438617462 -1.3208602837807617 +2.1621039885727726 +0.3206756715210520 -1.1633773309358162 +1.9011157852400937 +0.2820509050254881 +0.2387906637582263 +0.6787374774490297 +0.8898702331961810 -0.2123308536366983 +0.2291062764669780 }"

# solution from mode 0 as starting point
export GOF_MODE_1="{ +4.1178869398278692 -0.5593467315291294 -0.3187267010481231
 +0.3240199449995175 -3.4358741717273338 +0.9097865898648229
 -0.3104509203262014 -0.0086853110316726 +0.1341336556672175
 +0.0437258341639845 +0.0978775892654263 +0.1061278680290076
 +0.0069242850549833 -0.0516957186970947 -0.0820950732836047
 +0.0771365199974733 -0.0543217054378546 +0.1968283178730098
 +0.1545715183250960 -0.0956672376689121 +0.8224255784199731
 +0.2242375793376890 +0.1010522279865392 +0.3551697918471600
 +1.3073160428064310 +4.1574229765977604 +0.3378339027768105
 -2.5792619524220379 -4.9794517333963375 +0.3380358643769334
 -1.6581686891755774 -0.0664918299130530 -0.8109156666938554
 -0.0070573639008581 -0.0079892659700639 +1.0742977433119585
 +0.9879234436195085 +0.9458467709203215 +1.0379758085407931
 +0.2402717975255826 +0.9362113753239241 +1.1453505397623704
 +0.3308215769852905 -1.3075442981529661 +1.3907065361589983
 +0.2702280621504511 +0.0588300587137380 +0.0061776846783533
 +0.3194231834513575 -0.6104689733917655 +0.3501624316348181
 -1.2913297835254445 +2.1229639928347201 +0.3148124178743978
 -1.1575873577510567 +1.8546256782460027 +0.2667994789780362
 +0.0954594866953108 +0.6743594332216485 +0.8412909105554998
 -0.1589760433067680 +0.2288058243841434 }"

# initial point at SM values
export GOF_MODE_2="{ 4.27342842  0  0  0  -4.16611761  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0.827  0.22535  0.132  0.35  1.275  4.18  0.34  -2.1  -4.3  0.39  -2.2  0  0  0  0  1  1  1  1  0  1  1  0.389999999999998  -1.15  2.08  0.289999999999998  0.309999999999998  0.720000000000003  0.569999999999995  0.139999999999994  0.369999999999998  -1.07999999999999  2.47  0.309999999999998  -0.959999999999995  2.01  0.419999999999996  2.01999999999999  0.789999999999996  1.25999999999999  1.95999999999999  0.2276 }"

# take wilson coefficients and FF from mode_1 but set everything else
# to prior mode
export GOF_MODE_3="{
 +4.1178869398278692 -0.5593467315291294 -0.3187267010481231
 +0.3240199449995175 -3.4358741717273338 +0.9097865898648229
 -0.3104509203262014 -0.0086853110316726 +0.1341336556672175
 +0.0437258341639845 +0.0978775892654263 +0.1061278680290076
 +0.0069242850549833 -0.0516957186970947 -0.0820950732836047
 +0.0771365199974733 -0.0543217054378546 +0.1968283178730098
 +0.1545715183250960 -0.0956672376689121

0.827  0.22535  0.132  0.35  1.275  4.18  0.34  -2.1  -4.3  0.39  -2.2  0  0  0  0  1  1  1  1  0  1  1

 +0.3308215769852905 -1.3075442981529661 +1.3907065361589983
 +0.2702280621504511 +0.0588300587137380 +0.0061776846783533
 +0.3194231834513575 -0.6104689733917655 +0.3501624316348181
 -1.2913297835254445 +2.1229639928347201 +0.3148124178743978
 -1.1575873577510567 +1.8546256782460027 +0.2667994789780362
 +0.0954594866953108 +0.6743594332216485 +0.8412909105554998
 -0.1589760433067680 +0.2288058243841434 }"

# solution of mode 3
export GOF_MODE_4="{
+3.6601244948030809 -0.9901958434215717 -0.3787907949209672
 +0.2069355120954722 -3.4884576097082318 +0.8042950953667892
 -0.2463556905728113 +0.0290985926914019 +0.0806824604729511
 +0.0709327976404734 +0.1312975464383677 +0.1281213953802768
 +0.0302276499531199 -0.0809687809959071 -0.0468352589674889
 +0.0362870393660543 -0.0681155125131849 +0.2593519742260766
 +0.1753225391437148 -0.0486257714566977 +0.8255282657142193
 +0.2253783831832470 +0.1342123094233123 +0.3521417704390911
 +1.2770456766502960 +4.1827390781073275 +0.3431927957806427
 -2.4794192103605197 -4.4213352888198481 +0.3282634404894941
 -2.0511326714875580 -0.0039895508473669 -0.2176131898972171
 +0.0043582948718254 -0.0192469848204158 +1.0168376551419358
 +0.9922445794378297 +1.0153695390536193 +1.0273244057795097
 -0.0157974480968811 +0.9705505124947377 +1.0000231158368187
 +0.3320735686029128 -1.3200774868748804 +1.5283071773106449
 +0.2634439479786211 +0.0200406489956001 +0.0172307892945809
 +0.3375058124529491 -0.3779410394133552 +0.3524880726357514
 -1.2861556932851632 +2.0336983203087526 +0.3135848793013919
 -1.1552515949917266 +1.8292103262831529 +0.2616333383190362
 +0.1348053943592388 +0.6747155885378919 +0.8151051366868893
 -0.2688183126813983 +0.2284134545774539 }"

# all SM but FF taken from mode 4
export GOF_MODE_5="{
4.27342842  0  0  0  -4.16611761  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0.827  0.22535  0.132  0.35  1.275  4.18
+0.3431927957806427
 -2.4794192103605197 -4.4213352888198481 +0.3282634404894941
 -2.0511326714875580
    0  0  0  0  1  1  1  1  0  1  1
 +0.3320735686029128 -1.3200774868748804 +1.5283071773106449
 +0.2634439479786211 +0.0200406489956001 +0.0172307892945809
 +0.3375058124529491 -0.3779410394133552 +0.3524880726357514
 -1.2861556932851632 +2.0336983203087526 +0.3135848793013919
 -1.1552515949917266 +1.8292103262831529 +0.2616333383190362
 +0.1348053943592388 +0.6747155885378919 +0.8151051366868893
 -0.2688183126813983 +0.2284134545774539 }"
main $@
