#!/bin/bash
#SBATCH --mail-type=FAIL
#SBATCH --mail-user=vandyk@tp1.physik.uni-siegen.de
#SBATCH --mincpus=6
#SBATCH --nodes=1
#SBATCH --output=/scratch/vandyk/bayes2/all-norm/@DATE@/pmc_initial.slurm.out
#SBATCH --error=/scratch/vandyk/bayes2/all-norm/@DATE@/pmc_initial.slurm.err
#SBATCH --time=10:00:00
# vim: set sts=4 et:

SEED=12345
BASE_NAME=/scratch/vandyk/bayes2/all-norm/@DATE@/

source /home/vandyk/bayes2/constraints.bash
source /home/vandyk/bayes2/priors.bash

srun eos-scan-mc \
    --seed ${SEED} \
    --debug \
    --parallel 12 \
    --chunks 1 \
    --chunk-size 40000 \
    --use-pmc \
    --pmc-dof 6 \
    --pmc-initialize-from-file ${BASE_NAME}/mcmc_pre_merge.hdf5 \
    --pmc-hierarchical-clusters 50 \
    --global-local-covariance-window 1000 \
    --global-local-skip-initial 0.2 \
    --pmc-final-chunksize 40000 \
    --pmc-dof 6 \
    ${CONSTRAINTS_ALL} \
    --scan      "Re{c7}"      -2.0     +2.0              --prior flat \
    --scan      "Re{c7'}"     -2.0     +2.0              --prior flat \
    --scan      "Re{c9}"     -15.0    +15.0              --prior flat \
    --scan      "Re{c9'}"    -15.0    +15.0              --prior flat \
    --scan      "Re{c10}"    -15.0    +15.0              --prior flat \
    --scan      "Re{c10'}"   -15.0    +15.0              --prior flat \
    ${NUISANCE_CKM} \
    ${NUISANCE_QUARK_MASSES} \
    ${NUISANCE_DECAY_CONSTANTS} \
    ${NUISANCE_B_TO_VLL_HADRONICS} \
    ${NUISANCE_B_TO_VLL_FORM_FACTORS} \
    ${NUISANCE_B_TO_PLL_FORM_FACTORS} \
    --output "${BASE_NAME}/pmc_monolithic.hdf5" \
    > ${BASE_NAME}/pmc_monolithic.log 2>&1
exit
